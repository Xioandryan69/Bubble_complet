!function(){"use strict";function r(t){return 1===t.nodeType}function i(t,e){return e<0&&(e=0),e=m(t)&&(t=t.data.length)<e?t:e}function e(t,e){var n,r,i,o=c(t),f=g(t);if(null===t.dom.getParent(t.selection.getNode(),"a[href]")){var u=t.selection.getRng().cloneRange();if(u.startOffset<5){if(!(s=u.endContainer.previousSibling)){if(!u.endContainer.firstChild||!u.endContainer.firstChild.nextSibling)return;s=u.endContainer.firstChild.nextSibling}if(a=s.length,k(u,s,a),w(u,s,a),u.endOffset<5)return;n=u.endOffset,r=s}else{if(r=u.endContainer,!m(r)&&r.firstChild){for(;!m(r)&&r.firstChild;)r=r.firstChild;m(r)&&(k(u,r,0),w(u,r,r.nodeValue.length))}n=1===u.endOffset?2:u.endOffset-1-e}for(var a=n;k(u,r,2<=n?n-2:0),w(u,r,1<=n?n-1:0),--n,i=u.toString(),!C(i)&&0<=n-2;);C(u.toString())?(k(u,r,n),w(u,r,a),n+=1):(0===u.startOffset?k(u,r,0):k(u,r,n),w(u,r,a)),s=u.toString(),v(s.charAt(s.length-1))&&w(u,r,a-1);var s,e=(s=u.toString().trim()).match(o),a=h(t);e&&(s=e[0],l(s,"www.")?s=a+"://"+s:d(s,"@")&&!y(s)&&(s="mailto:"+s),o=t.selection.getBookmark(),t.selection.setRng(u),t.execCommand("createlink",!1,s),!1!==f&&t.dom.setAttrib(t.selection.getNode(),"target",f),t.selection.moveToBookmark(o),t.nodeChanged())}}var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),d=function(t,e){return-1!==t.indexOf(e)},l=function(t,e){return t=t,n=0,""===(e=e)||t.length>=e.length&&t.substr(n,n+e.length)===e;var n},o=tinymce.util.Tools.resolve("tinymce.Env"),n=new RegExp("^"+/(?:[A-Za-z][A-Za-z\d.+-]{0,14}:\/\/(?:[-.~*+=!&;:'%@?^${}(),\w]+@)?|www\.|[-;:&=+$,.\w]+@)[A-Za-z\d-]+(?:\.[A-Za-z\d-]+)*(?::\d+)?(?:\/(?:[-.~*+=!;:'%@$(),\/\w]*[-~*+=%@$()\/\w])?)?(?:\?(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?(?:#(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?/g.source+"$","i"),c=function(t){return t.getParam("autolink_pattern",n)},g=function(t){return t.getParam("default_link_target",!1)},h=function(t){return t.getParam("link_default_protocol","http","string")},C=function(t){return/^[(\[{ \u00a0]$/.test(t)},m=function(t){return 3===t.nodeType},f=function(t){return e(t,-1)},u=function(t){return e(t,0)},a=function(t){return e(t,-1)},k=function(t,e,n){!r(e)||e.hasChildNodes()?t.setStart(e,i(e,n)):t.setStartBefore(e)},w=function(t,e,n){!r(e)||e.hasChildNodes()?t.setEnd(e,i(e,n)):t.setEndAfter(e)},y=function(t){return/^([A-Za-z][A-Za-z\d.+-]*:\/\/)|mailto:/.test(t)},v=function(t){return/[?!,.;:]/.test(t)};t.add("autolink",function(t){var e,n;(e=t).on("keydown",function(t){if(13===t.keyCode)return a(e)}),o.browser.isIE()?e.on("focus",function(){if(!n){n=!0;try{e.execCommand("AutoUrlDetect",!1,!0)}catch(t){}}}):(e.on("keypress",function(t){if(41===t.keyCode||93===t.keyCode||125===t.keyCode)return f(e)}),e.on("keyup",function(t){if(32===t.keyCode)return u(e)}))})}();