!function(){"use strict";function s(t){var e=t;return{get:function(){return e},set:function(t){e=t}}}function f(t){return t.getParam("fullpage_hide_in_source_view")}function m(t,e){return n({validate:!1,root_name:"#document"},t.schema).parse(e,{format:"xhtml"})}function e(t,e){function n(t,e){return t.attr(e)||""}var i,e=m(t,e),l={};return l.fontface=v(t),l.fontsize=_(t),7===(t=e.firstChild).type&&(l.xml_pi=!0,i=/encoding="([^"]+)"/.exec(t.value))&&(l.docencoding=i[1]),(t=e.getAll("#doctype")[0])&&(l.doctype="<!DOCTYPE"+t.value+">"),(t=e.getAll("title")[0])&&t.firstChild&&(l.title=t.firstChild.value),p.each(e.getAll("meta"),function(t){var e=t.attr("name"),n=t.attr("http-equiv");e?l[e.toLowerCase()]=t.attr("content"):"Content-Type"===n&&(e=/charset\s*=\s*(.*)\s*/gi.exec(t.attr("content")))&&(l.docencoding=e[1])}),(t=e.getAll("html")[0])&&(l.langcode=n(t,"lang")||n(t,"xml:lang")),l.stylesheets=[],p.each(e.getAll("link"),function(t){"stylesheet"===t.attr("rel")&&l.stylesheets.push(t.attr("href"))}),(t=e.getAll("body")[0])&&(l.langdir=n(t,"dir"),l.style=n(t,"style"),l.visited_color=n(t,"vlink"),l.link_color=n(t,"link"),l.active_color=n(t,"alink")),l}function o(t,o,e){function n(t,e,n){t.attr(e,n||void 0)}function r(t){l.firstChild?l.insert(t,l.firstChild):l.append(t)}var a,i=t.dom,c=m(t,e),l=c.getAll("head")[0],s=(l||(a=c.getAll("html")[0],l=new d("head",1),a.firstChild?a.insert(l,a.firstChild,!0):a.append(l)),a=c.firstChild,o.xml_pi?(e='version="1.0"',o.docencoding&&(e+=' encoding="'+o.docencoding+'"'),7!==a.type&&(a=new d("xml",7),c.insert(a,c.firstChild,!0)),a.value=e):a&&7===a.type&&a.remove(),a=c.getAll("#doctype")[0],o.doctype?(a||(a=new d("#doctype",10),o.xml_pi?c.insert(a,c.firstChild):r(a)),a.value=o.doctype.substring(9,o.doctype.length-1)):a&&a.remove(),a=null,p.each(c.getAll("meta"),function(t){"Content-Type"===t.attr("http-equiv")&&(a=t)}),o.docencoding?(a||((a=new d("meta",1)).attr("http-equiv","Content-Type"),a.shortEnded=!0,r(a)),a.attr("content","text/html; charset="+o.docencoding)):a&&a.remove(),a=c.getAll("title")[0],o.title?(a?a.empty():(a=new d("title",1),r(a)),a.append(new d("#text",3)).value=o.title):a&&a.remove(),p.each("keywords,description,author,copyright,robots".split(","),function(t){for(var e,n=c.getAll("meta"),i=o[t],l=0;l<n.length;l++)if((e=n[l]).attr("name")===t)return void(i?e.attr("content",i):e.remove());i&&((a=new d("meta",1)).attr("name",t),a.attr("content",i),a.shortEnded=!0,r(a))}),{});return p.each(c.getAll("link"),function(t){"stylesheet"===t.attr("rel")&&(s[t.attr("href")]=t)}),p.each(o.stylesheets,function(t){s[t]||((a=new d("link",1)).attr({rel:"stylesheet",text:"text/css",href:t}),a.shortEnded=!0,r(a)),delete s[t]}),p.each(s,function(t){t.remove()}),(a=c.getAll("body")[0])&&(n(a,"dir",o.langdir),n(a,"style",o.style),n(a,"vlink",o.visited_color),n(a,"link",o.link_color),n(a,"alink",o.active_color),i.setAttribs(t.getBody(),{style:o.style,dir:o.dir,vLink:o.visited_color,link:o.link_color,aLink:o.active_color})),(a=c.getAll("html")[0])&&(n(a,"lang",o.langcode),n(a,"xml:lang",o.langcode)),l.firstChild||l.remove(),(e=u({validate:!1,indent:!0,indent_before:"head,html,body,meta,title,script,link,style",indent_after:"head,html,body,meta,title,script,link,style"}).serialize(c)).substring(0,e.indexOf("</body>"))}function g(t){return t.replace(/<\/?[A-Z]+/g,function(t){return t.toLowerCase()})}var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),r=function(){return(r=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var l in e=arguments[n])Object.prototype.hasOwnProperty.call(e,l)&&(t[l]=e[l]);return t}).apply(this,arguments)},p=tinymce.util.Tools.resolve("tinymce.util.Tools"),n=tinymce.util.Tools.resolve("tinymce.html.DomParser"),d=tinymce.util.Tools.resolve("tinymce.html.Node"),u=tinymce.util.Tools.resolve("tinymce.html.Serializer"),h=function(t){return t.getParam("fullpage_default_xml_pi")},y=function(t){return t.getParam("fullpage_default_encoding")},v=function(t){return t.getParam("fullpage_default_font_family")},_=function(t){return t.getParam("fullpage_default_font_size")},b=function(t){return t.getParam("fullpage_default_text_color")},x=function(t){return t.getParam("fullpage_default_title")},k=function(t){return t.getParam("fullpage_default_doctype","<!DOCTYPE html>")},C=function(n,i){var l=e(n,i.get()),t=r(r({},{title:"",keywords:"",description:"",robots:"",author:"",docencoding:""}),l);n.windowManager.open({title:"Metadata and Document Properties",size:"normal",body:{type:"panel",items:[{name:"title",type:"input",label:"Title"},{name:"keywords",type:"input",label:"Keywords"},{name:"description",type:"input",label:"Description"},{name:"robots",type:"input",label:"Robots"},{name:"author",type:"input",label:"Author"},{name:"docencoding",type:"input",label:"Encoding"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:t,onSubmit:function(t){var e=t.getData(),e=o(n,p.extend(l,e),i.get());i.set(e),t.close()}})},A=p.each,w=function(t,e,n,i){var l,o,r,a,c,s,d="",u=t.dom;i.selection||(o=t.getParam("protect"),r=i.content,p.each(o,function(t){r=r.replace(t,function(t){return"\x3c!--mce:protected "+escape(t)+"--\x3e"})}),o=r,"raw"===i.format&&e.get())||i.source_view&&f(t)||(-1!==(a=(o=(o=0!==o.length||i.source_view?o:p.trim(e.get())+"\n"+p.trim(o)+"\n"+p.trim(n.get())).replace(/<(\/?)BODY/gi,"<$1body")).indexOf("<body"))?(a=o.indexOf(">",a),e.set(g(o.substring(0,a+1))),-1===(l=o.indexOf("</body",a))&&(l=o.length),i.content=p.trim(o.substring(a+1,l)),n.set(g(o.substring(l)))):(e.set(function(t){var e="",n,i="";if(h(t)){var l=y(t);e+='<?xml version="1.0" encoding="'+(l?l:"ISO-8859-1")+'" ?>\n'}if(e=e+k(t)+"\n<html>\n<head>\n",n=x(t))e+="<title>"+n+"</title>\n";if(n=y(t))e+='<meta http-equiv="Content-Type" content="text/html; charset='+n+'" />\n';if(n=v(t))i+="font-family: "+n+";";if(n=_(t))i+="font-size: "+n+";";if(n=b(t))i+="color: "+n+";";return e+="</head>\n<body"+(i?' style="'+i+'"':"")+">\n"}(t)),n.set("\n</body>\n</html>")),i=m(t,e.get()),A(i.getAll("style"),function(t){t.firstChild&&(d+=t.firstChild.value)}),(a=i.getAll("body")[0])&&u.setAttribs(t.getBody(),{style:a.attr("style")||"",dir:a.attr("dir")||"",vLink:a.attr("vlink")||"",link:a.attr("link")||"",aLink:a.attr("alink")||""}),u.remove("fullpage_styles"),c=t.getDoc().getElementsByTagName("head")[0],d&&u.add(c,"style",{id:"fullpage_styles"}).appendChild(document.createTextNode(d)),s={},p.each(c.getElementsByTagName("link"),function(t){"stylesheet"===t.rel&&t.getAttribute("data-mce-fullpage")&&(s[t.href]=t)}),p.each(i.getAll("link"),function(t){var e=t.attr("href");if(!e)return!0;s[e]||"stylesheet"!==t.attr("rel")||u.add(c,"link",{rel:"stylesheet",text:"text/css",href:e,"data-mce-fullpage":"1"}),delete s[e]}),p.each(s,function(t){t.parentNode.removeChild(t)}))},P=function(t,e,n,i){"html"!==i.format||i.selection||i.source_view&&f(t)||(i.content=(p.trim(e)+"\n"+p.trim(i.content)+"\n"+p.trim(n)).replace(/<!--mce:protected ([\s\S]*?)-->/g,function(t,e){return unescape(e)}))};t.add("fullpage",function(t){var e,n,i,l,o,r,a=s(""),c=s("");n=a,(e=t).addCommand("mceFullPageProperties",function(){C(e,n)}),(i=t).ui.registry.addButton("fullpage",{tooltip:"Metadata and document properties",icon:"document-properties",onAction:function(){i.execCommand("mceFullPageProperties")}}),i.ui.registry.addMenuItem("fullpage",{text:"Metadata and document properties",icon:"document-properties",onAction:function(){i.execCommand("mceFullPageProperties")}}),o=a,r=c,(l=t).on("BeforeSetContent",function(t){w(l,o,r,t)}),l.on("GetContent",function(t){P(l,o.get(),r.get(),t)})})}();