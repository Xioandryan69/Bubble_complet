!function(){"use strict";function t(n){return function(t){return e=typeof(t=t),(null===t?"null":"object"==e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e)===n;var e}}function i(t){return t.getParam("importcss_selector_converter")}function o(t,e){for(var n=function(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;o++){var i=t[o];r[o]=e(i,o)}return r}(t,e),r=[],o=0,i=n.length;o<i;++o){if(!s(n[o]))throw new Error("Arr.flatten item "+o+" was not an array, input: "+n);v.apply(r,n[o])}return r}function c(t,e){return null===e||!1!==t.getParam("importcss_exclusive")}function n(c){c.on("init",function(){function r(t,e){if(k(c,t,e,n)){w(c,t,e,n);t=A(c,c.plugins.importcss,t,e);if(t)return e=t.name||u.DOM.uniqueId(),c.formatter.register(e,t),{title:t.title,format:e}}return null}var o=d(),n={},e=x(a(c)),i=S(g(c)),t=(p.each(P(c,c.getDoc(),x(h(c))),function(n){var t;_.test(n)||e&&!e(n)||(0<(t=b(i,n)).length?p.each(t,function(t){var e=r(n,t);e&&o.addItemToGroup(t.title,e)}):(t=r(n,null))&&o.addItem(t))}),o.toFormats());c.fire("addStyleModifications",{items:t,replace:!y(c)})})}var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),l=t("string"),s=t("array"),u=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),f=tinymce.util.Tools.resolve("tinymce.EditorManager"),m=tinymce.util.Tools.resolve("tinymce.Env"),p=tinymce.util.Tools.resolve("tinymce.util.Tools"),a=function(t){return t.getParam("importcss_selector_filter")},g=function(t){return t.getParam("importcss_groups")},y=function(t){return t.getParam("importcss_append")},h=function(t){return t.getParam("importcss_file_filter")},v=Array.prototype.push,d=function(){var e=[],n=[],r={};return{addItemToGroup:function(t,e){r[t]?r[t].push(e):(n.push(t),r[t]=[e])},addItem:function(t){e.push(t)},toFormats:function(){return o(n,function(t){var e=r[t];return 0===e.length?[]:[{title:t,items:e}]}).concat(e)}}},_=/^\.(?:ephox|tiny-pageembed|mce)(?:[.-]+\w+)+$/,x=function(e){return l(e)?function(t){return-1!==t.indexOf(e)}:e instanceof RegExp?function(t){return e.test(t)}:e},P=function(c,t,s){function u(t,e){var n,r,o,i=t.href;if(r=i,o=m.cacheSuffix,(i=r=l(r)?r.replace("?"+o,"").replace("&"+o,""):r)&&s(i,e)&&(o=i,!(e=function(t){t=t.getParam("skin");return!1!==t&&(t||"oxide")}(r=c))||(i=(i=r.getParam("skin_url"))?r.documentBaseURI.toAbsolute(i):f.baseURL+"/skins/ui/"+e,e=f.baseURL+"/skins/content/",o!==i+"/content"+(r.inline?".inline":"")+".min.css"&&-1===o.indexOf(e)))){p.each(t.imports,function(t){u(t,!0)});try{n=t.cssRules||t.rules}catch(t){}p.each(n,function(t){t.styleSheet?u(t.styleSheet,!0):t.selectorText&&p.each(t.selectorText.split(","),function(t){a.push(p.trim(t))})})}}var a=[],n={};p.each(c.contentCSS,function(t){n[t]=!0}),s=s||function(t,e){return e||n[t]};try{p.each(t.styleSheets,function(t){u(t)})}catch(t){}return a},T=function(t,e){var n,r,o,i,c=/^(?:([a-z0-9\-_]+))?(\.[a-z0-9_\-\.]+)$/i.exec(e);if(c)return r=c[1],o=c[2].substr(1).split(".").join(" "),i=p.makeMap("a,img"),c[1]?(n={title:e},t.schema.getTextBlockElements()[r]?n.block=r:t.schema.getBlockElements()[r]||i[r.toLowerCase()]?n.selector=r:n.inline=r):c[2]&&(n={inline:"span",title:e.substr(1),classes:o}),!1!==t.getParam("importcss_merge_classes")?n.classes=o:n.attributes={class:o},n},b=function(t,e){return p.grep(t,function(t){return!t.filter||t.filter(e)})},S=function(t){return p.map(t,function(t){return p.extend({},t,{original:t,selectors:{},filter:x(t.filter)})})},k=function(t,e,n,r){return!(c(t,n)?e in r:e in n.selectors)},w=function(t,e,n,r){c(t,n)?r[e]=!0:n.selectors[e]=!0},A=function(t,e,n,r){var o=r&&r.selector_converter?r.selector_converter:i(t)?i(t):function(){return T(t,n)};return o.call(e,n,r)};e.add("importcss",function(t){return n(t),e=t,{convertSelectorToFormat:function(t){return T(e,t)}};var e})}();