!function(){"use strict";function t(n){return function(t){return e=typeof(t=t),(null===t?"null":"object"==e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e)===n;var e}}function e(e){return function(t){return typeof t===e}}function i(t){return function(){return t}}function n(t){return t}function r(){return E}var o,u=tinymce.util.Tools.resolve("tinymce.PluginManager"),c=0,a=function(t,e,n){var r,o,i;t.plugins.table?t.plugins.table.insertTable(e,n):(o=e,i=n,(r=t).undoManager.transact(function(){r.insertContent(function(t,e){var n='<table data-mce-id="mce" style="width: 100%">';n+="<tbody>";for(var r=0;r<e;r++){n+="<tr>";for(var o=0;o<t;o++)n+="<td><br></td>";n+="</tr>"}return n=n+"</tbody>"+"</table>"}(o,i));var t=r.dom.select("*[data-mce-id]")[0],t=(t.removeAttribute("data-mce-id"),r.dom.select("td,th",t));r.selection.setCursorLocation(t[0],0)}))},l=function(t,e,n){var r,o=t.editorUpload.blobCache,i=o.create((i="mceu",r=(new Date).getTime(),i+"_"+Math.floor(1e9*Math.random())+ ++c+String(r)),n,e);o.add(i),t.insertContent(t.dom.createHTML("img",{src:i.blobUri()}))},f=tinymce.util.Tools.resolve("tinymce.util.Promise"),s=function(n){return new f(function(t){var e=new FileReader;e.onloadend=function(){t(e.result.split(",")[1])},e.readAsDataURL(n)})},d=tinymce.util.Tools.resolve("tinymce.Env"),m=tinymce.util.Tools.resolve("tinymce.util.Delay"),g=function(i){return new f(function(n){var r=document.createElement("input"),o=(r.type="file",r.accept="image/*",r.style.position="fixed",r.style.left="0",r.style.top="0",r.style.opacity="0.001",document.body.appendChild(r),r.addEventListener("change",function(t){n(Array.prototype.slice.call(t.target.files))}),function(t){function e(){n([]),r.parentNode.removeChild(r)}d.os.isAndroid()&&"remove"!==t.type?m.setEditorTimeout(i,e,0):e(),i.off("focusin remove",o)});i.on("focusin remove",o),r.click()})},h=t("string"),p=t("object"),b=t("array"),y=e("boolean"),v=function(t){return o===t},k=e("function"),w=i(!1),T=i(!(o=void 0)),E={fold:function(t,e){return t()},isSome:w,isNone:T,getOr:n,getOrThunk:N,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:n,orThunk:N,map:r,each:function(){},bind:r,exists:w,forall:T,filter:function(){return E},toArray:function(){return[]},toString:i("none()")};function N(t){return t()}function M(n){function t(){return o}function e(t){return t(n)}var r=i(n),o={fold:function(t,e){return e(n)},isSome:T,isNone:w,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:t,orThunk:t,map:function(t){return M(t(n))},each:function(t){t(n)},bind:e,exists:e,forall:e,filter:function(t){return t(n)?o:E},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return o}var S=M,C=r,O=function(t){return null==t?E:M(t)};function q(t,e,n,r,o){return t(n,r)?S(n):k(o)&&o(n)?C():e(n,r,o)}function x(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:t}}function A(t,e){if(1!==(t=t.dom).nodeType)return!1;if(void 0!==t.matches)return t.matches(e);if(void 0!==t.msMatchesSelector)return t.msMatchesSelector(e);if(void 0!==t.webkitMatchesSelector)return t.webkitMatchesSelector(e);if(void 0!==t.mozMatchesSelector)return t.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}function D(t,e,n){for(var r=t.dom,o=k(n)?n:w;r.parentNode;){var r=r.parentNode,i=P.fromDom(r);if(e(i))return S(i);if(o(i))break}return C()}function U(t,e,n){return D(t,function(t){return A(t,e)},n)}function B(o){var t=z(o);0<t.trim().length&&o.ui.registry.addContextToolbar("quickblock",{predicate:function(t){function e(t){return t.dom===o.getBody()}var n=P.fromDom(t),r=o.schema.getTextBlockElements();return j(n,"table",e).fold(function(){return I(n,function(t){return F(t)in r&&o.dom.isEmpty(t.dom)},e).isSome()},w)},items:t,position:"line",scope:"editor"})}function H(e){function n(t){return"IMG"===t.nodeName||"FIGURE"===t.nodeName&&/image/i.test(t.className)}var t=G(e);0<t.trim().length&&e.ui.registry.addContextToolbar("imageselection",{predicate:n,items:t,position:"node"}),0<(t=R(e)).trim().length&&e.ui.registry.addContextToolbar("textselection",{predicate:function(t){return!n(t)&&!e.selection.isCollapsed()&&"false"!==e.dom.getContentEditableParent(t)},items:t,position:"selection",scope:"editor"})}var L,P={fromHtml:function(t,e){e=(e||document).createElement("div");if(e.innerHTML=t,!e.hasChildNodes()||1<e.childNodes.length)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return x(e.childNodes[0])},fromTag:function(t,e){e=(e||document).createElement(t);return x(e)},fromText:function(t,e){e=(e||document).createTextNode(t);return x(e)},fromDom:x,fromPoint:function(t,e,n){return O(t.dom.elementFromPoint(e,n)).map(x)}},F=("undefined"!=typeof window||Function("return this;")(),function(t){return t.dom.nodeName.toLowerCase()}),I=function(t,e,n){return q(function(t,e){return e(t)},D,t,e,n)},j=function(t,e,n){return q(A,U,t,e,n)},_=(L=h,function(t,e,n){!function(t,e){if(e(t))return;throw new Error("Default value doesn't match requested type.")}(n,L);t=t.getParam(e,n),e=n;if(b(t)||p(t))throw new Error("expected a string but found: "+t);return v(t)?e:y(t)?!1===t?"":e:t}),R=function(t){return _(t,"quickbars_selection_toolbar","bold italic | quicklink h2 h3 blockquote")},z=function(t){return _(t,"quickbars_insert_toolbar","quickimage quicktable")},G=function(t){return _(t,"quickbars_image_toolbar","alignleft aligncenter alignright")};u.add("quickbars",function(t){var n;(n=t).ui.registry.addButton("quickimage",{icon:"image",tooltip:"Insert image",onAction:function(){g(n).then(function(t){var e;0<t.length&&(e=t[0],s(e).then(function(t){l(n,t,e)}))})}}),n.ui.registry.addButton("quicktable",{icon:"table",tooltip:"Insert table",onAction:function(){a(n,2,2)}}),B(t),H(t)})}();