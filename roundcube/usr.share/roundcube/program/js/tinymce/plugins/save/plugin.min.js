!function(){"use strict";function o(e){return e.getParam("save_enablewhendirty",!0)}function t(e,n){e.notificationManager.open({text:n,type:"error"})}var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),i=tinymce.util.Tools.resolve("tinymce.util.Tools"),c=function(e){var n=a.DOM.getParent(e.id,"form");o(e)&&!e.isDirty()||(e.save(),e.getParam("save_onsavecallback")?(e.execCallback("save_onsavecallback",e),e.nodeChanged()):n?(e.setDirty(!1),n.onsubmit&&!n.onsubmit()||("function"==typeof n.submit?n.submit():t(e,"Error: Form submit field collision.")),e.nodeChanged()):t(e,"Error: No form element found."))},r=function(e){var n=i.trim(e.startContent);e.getParam("save_oncancelcallback")?e.execCallback("save_oncancelcallback",e):e.resetContent(n)},l=function(t){return function(e){function n(){e.setDisabled(o(t)&&!t.isDirty())}return n(),t.on("NodeChange dirty",n),function(){return t.off("NodeChange dirty",n)}}};e.add("save",function(e){var n,t;(n=e).ui.registry.addButton("save",{icon:"save",tooltip:"Save",disabled:!0,onAction:function(){return n.execCommand("mceSave")},onSetup:l(n)}),n.ui.registry.addButton("cancel",{icon:"cancel",tooltip:"Cancel",disabled:!0,onAction:function(){return n.execCommand("mceCancel")},onSetup:l(n)}),n.addShortcut("Meta+S","","mceSave"),(t=e).addCommand("mceSave",function(){c(t)}),t.addCommand("mceCancel",function(){r(t)})})}();