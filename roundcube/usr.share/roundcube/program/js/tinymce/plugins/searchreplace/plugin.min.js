!function(){"use strict";function u(e){var t=e;return{get:function(){return t},set:function(e){t=e}}}function e(n){return function(e){return t=typeof(e=e),(null===e?"null":"object"==t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t)===n;var t}}function t(t){return function(e){return typeof e===t}}function o(){}function i(e){return function(){return e}}function n(e){return e}function r(){return l}var D=tinymce.util.Tools.resolve("tinymce.PluginManager"),g=function(){return(g=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},W=e("string"),j=e("array"),V=t("boolean"),U=t("number"),a=i(!1),c=i(!0),$=i("[!-#%-*,-\\/:;?@\\[-\\]_{}¡«·»¿;·՚-՟։֊־׀׃׆׳״؉؊،؍؛؞؟٪-٭۔܀-܍߷-߹࠰-࠾࡞।॥॰෴๏๚๛༄-༒༺-༽྅࿐-࿔࿙࿚၊-၏჻፡-፨᐀᙭᙮᚛᚜᛫-᛭᜵᜶។-៖៘-៚᠀-᠊᥄᥅᨞᨟᪠-᪦᪨-᪭᭚-᭠᯼-᯿᰻-᰿᱾᱿᳓‐-‧‰-⁃⁅-⁑⁓-⁞⁽⁾₍₎〈〉❨-❵⟅⟆⟦-⟯⦃-⦘⧘-⧛⧼⧽⳹-⳼⳾⳿⵰⸀-⸮⸰⸱、-〃〈-】〔-〟〰〽゠・꓾꓿꘍-꘏꙳꙾꛲-꛷꡴-꡷꣎꣏꣸-꣺꤮꤯꥟꧁-꧍꧞꧟꩜-꩟꫞꫟꯫﴾﴿︐-︙︰-﹒﹔-﹡﹣﹨﹪﹫！-＃％-＊，-／：；？＠［-］＿｛｝｟-･]"),l={fold:function(e,t){return e()},isSome:a,isNone:c,getOr:n,getOrThunk:s,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:n,orThunk:s,map:r,each:o,bind:r,exists:a,forall:c,filter:function(){return l},toArray:function(){return[]},toString:i("none()")};function s(e){return e()}function f(n){function e(){return o}function t(e){return e(n)}var r=i(n),o={fold:function(e,t){return t(n)},isSome:c,isNone:a,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:e,orThunk:e,map:function(e){return f(e(n))},each:function(e){e(n)},bind:t,exists:t,forall:t,filter:function(e){return e(n)?o:l},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return o}function d(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r}function m(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function h(e,t){for(var n=e.length-1;0<=n;n--)t(e[n],n)}function p(e,t){for(var n=d(e,t),r=[],o=0,i=n.length;o<i;++o){if(!j(n[o]))throw new Error("Arr.flatten item "+o+" was not an array, input: "+n);q.apply(r,n[o])}return r}function v(e,t){return G.call(e,t)}var _=f,y=r,x=function(e){return null==e?l:f(e)},b=$,w=tinymce.util.Tools.resolve("tinymce.Env"),O=tinymce.util.Tools.resolve("tinymce.util.Tools"),z=Array.prototype.slice,q=Array.prototype.push,G=Object.hasOwnProperty;"undefined"==typeof window&&Function("return this;")();Q=3;function K(e,t,n){if(e=e.dom,!(W(n)||V(n)||U(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")}function H(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}}function C(e,t){return{element:e,offset:t}}function J(e,t){var n=d(e.dom.childNodes,T);return 0<n.length&&t<n.length?C(n[t],0):C(e,t)}function L(t,n){x(t.dom.parentNode).map(T).each(function(e){e.dom.insertBefore(n.dom,t.dom)})}function k(e,t){L(e,t),t.dom.appendChild(e.dom)}var Q,E,S,T=H,X=(E=function(e){return e.dom.nodeType===Q},S="text",{get:function(e){if(E(e))return Y(e).getOr("");throw new Error("Can only get "+S+" value of a "+S+" node")},getOption:Y,set:function(e,t){if(!E(e))throw new Error("Can only set raw "+S+" value of a "+S+" node");e.dom.nodeValue=t}});function Y(e){return E(e)?x(e.dom.nodeValue):y()}function Z(e){return X.get(e)}function ee(e,t){return t=t,e=void 0===(e=e)?document:e.dom,1!==(n=e).nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount?[]:d(e.querySelectorAll(t),T);var n}function te(e,t){return e.isBlock(t)||v(e.schema.getShortEndedElements(),t.nodeName)}function ne(e,t){return"false"===e.getContentEditable(t)}function re(e,t){return!e.isBlock(t)&&v(e.schema.getWhiteSpaceElements(),t.nodeName)}function oe(){return{sOffset:0,fOffset:0,elements:[]}}function ie(e,t){return J(T(e),t)}function ae(e,t,n,r,o,i){for(var a=(i=void 0===i?!0:i)?t(!1):n;a;){var c=ne(e,a);if(c||re(e,a)){if(c?r.cef(a):r.boundary(a))break;a=t(!0)}else{if(te(e,a)){if(r.boundary(a))break}else 3===a.nodeType&&r.text(a);if(a===o)break;a=t(!1)}}}function ce(e,t,n,r,o){var i,a;te(i=e,a=n)||ne(i,a)||re(i,a)||(a=a,"true"===(i=i).getContentEditable(a)&&"false"===i.getContentEditableParent(a.parentNode))||(i=e.getParent(r,e.isBlock),a=new be(n,i),r=(o?a.next:a.prev).bind(a),ae(e,r,n,{boundary:c,cef:c,text:function(e){o?t.fOffset+=e.length:t.sOffset+=e.length,t.elements.push(T(e))}}))}function ue(e,t,n,r,o,i){function a(){return 0<l.elements.length&&(u.push(l),l=oe()),!1}void 0===i&&(i=!0);var c=new be(n,t),u=[],l=oe();return ce(e,l,n,t,!1),ae(e,c.next.bind(c),n,{boundary:a,cef:function(e){return a(),o&&u.push.apply(u,o.cef(e)),!1},text:function(e){l.elements.push(T(e)),o&&o.text(e,l)}},r,i),r&&ce(e,l,r,t,!0),a(),u}function le(n,e){var r=ie(e.startContainer,e.startOffset),o=r.element.dom,i=ie(e.endContainer,e.endOffset),a=i.element.dom;return ue(n,e.commonAncestorContainer,o,a,{text:function(e,t){e===a?t.fOffset+=e.length-i.offset:e===o&&(t.sOffset+=r.offset)},cef:function(e){var e=p(ee(T(e),"*[contenteditable=true]"),function(e){e=e.dom;return ue(n,e,e)}),t=function(e,t){return e=e.elements[0].dom,t=t.elements[0].dom,n=Node.DOCUMENT_POSITION_PRECEDING,0!=(e.compareDocumentPosition(t)&n)?1:-1;var n};return(e=z.call(e,0)).sort(t),e}},!1)}function se(e,t){return t.collapsed?[]:le(e,t)}function fe(e,t){var n=e.createRng();return n.selectNode(t),se(e,n)}function de(e,i){n=function(e,n){var t=Z(n),r=e.last,o=r+t.length,t=p(i,function(e,t){return e.start<o&&e.finish>r?[{element:n,start:Math.max(r,e.start)-r,finish:Math.min(o,e.finish)-r,matchId:t}]:[]});return{results:e.results.concat(t),last:o}},r={results:[],last:0},m(e,function(e,t){r=n(r,e,t)});var n,r,t=r.results,o=function(e){return e.matchId};if(0===t.length)return[];for(var a=o(t[0]),c=[],u=[],l=0,s=t.length;l<s;l++){var f=t[l],d=o(f);d!==a&&(c.push(u),u=[]),a=d,u.push(f)}return 0!==u.length&&c.push(u),c}function me(r,e){return p(e,function(e){var t=e.elements,n=d(t,Z).join(""),n=function(e,t,n,r){void 0===r&&(r=e.length);for(var o=t.regex,i=(o.lastIndex=n=void 0===n?0:n,[]);c=o.exec(e);){var a=c[t.matchIndex],c=c.index+c[0].indexOf(a),a=c+a.length;if(r<a)break;i.push({start:c,finish:a}),o.lastIndex=a}return i}(n,r,e.sOffset,n.length-e.fOffset);return de(t,n)})}function ge(e,o){h(e,function(e,r){h(e,function(e){var t=T(o.cloneNode(!1)),n=(K(t,"data-mce-index",r),e.element.dom);n.length===e.finish&&0===e.start?k(e.element,t):(n.length!==e.finish&&n.splitText(e.finish),n=n.splitText(e.start),k(T(n),t))})})}function he(e,t,n,r){var o,i=n.getBookmark(),a=0<(a=e.select("td[data-mce-selected],th[data-mce-selected]")).length?(o=e,p(a,function(e){return fe(o,e)})):se(e,n.getRng()),e=me(t,a);return ge(e,r),n.moveToBookmark(i),e.length}function pe(e,t,n,r){var o=e.dom.create("span",{"data-mce-bogus":1}),i=(o.className="mce-match-marker",e.getBody());return R(e,t,!1),r?he(e.dom,n,e.selection,o):(t=e.dom,r=n,e=o,t=fe(t,n=i),n=me(r,t),ge(n,e),n.length)}function N(e,t){var n=[],r=O.toArray(e.getBody().getElementsByTagName("span"));if(r.length)for(var o=0;o<r.length;o++){var i=B(r[o]);null!==i&&i.length&&i===t.toString()&&n.push(r[o])}return n}function A(e,t,n){var r=(t=t.get()).index,o=e.dom;return(n=!1!==n)?r+1===t.count?r=0:r++:r-1==-1?r=t.count-1:r--,o.removeClass(N(e,t.index),"mce-match-marker-selected"),(n=N(e,r)).length?(o.addClass(N(e,r),"mce-match-marker-selected"),e.selection.scrollIntoView(n[0]),r):-1}function ve(e,t){var n=t.parentNode;e.remove(t),e.isEmpty(n)&&e.remove(n)}function ye(e){return null!==(e=B(e))&&0<e.length}function xe(){e=o,t=u(y());var e,t,n={clear:function(){r(),t.set(y())},isSet:function(){return t.get().isSome()},get:function(){return t.get()},set:function(e){r(),t.set(_(e))}};function r(){t.get().each(e)}return g(g({},n),{on:function(e){return n.get().each(e)}})}var be=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),B=function(e){e=e.getAttribute("data-mce-index");return"number"==typeof e?""+e:e},we=function(e){var t=e.parentNode;e.firstChild&&t.insertBefore(e.firstChild,e),e.parentNode.removeChild(e)},Oe=function(e,t,n,r,o,i){var a=e.selection,c=function(e,t){e="("+e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").replace(/\s/g,"[^\\S\\r\\n\\uFEFF]")+")";return t?"(?:^|\\s|"+b()+")"+e+"(?=$|\\s|"+b()+")":e}(n,o),u=a.isForward(),c={regex:new RegExp(c,r?"g":"gi"),matchIndex:1},c=pe(e,t,c,i);return w.browser.isSafari()&&a.setRng(a.getRng(),u),c&&(a=A(e,t,!0),t.set({index:a,count:c,text:n,matchCase:r,wholeWord:o,inSelection:i})),c},F=function(e,t){e=A(e,t,!0);t.set(g(g({},t.get()),{index:e}))},I=function(e,t){e=A(e,t,!1);t.set(g(g({},t.get()),{index:e}))},M=function(e,t,n,r,o){for(var i,a=t.get(),c=a.index,u=c,l=(r=!1!==r,e.getBody()),s=O.grep(O.toArray(l.getElementsByTagName("span")),ye),f=0;f<s.length;f++){var d=B(s[f]),m=i=parseInt(d,10);if(o||m===a.index){for(n.length?(s[f].firstChild.nodeValue=n,we(s[f])):ve(e.dom,s[f]);s[++f];){if((m=parseInt(B(s[f]),10))!==i){f--;break}ve(e.dom,s[f])}r&&u--}else c<i&&s[f].setAttribute("data-mce-index",String(i-1))}return t.set(g(g({},a),{count:o?0:a.count-1,index:u})),(r?F:I)(e,t),!o&&0<t.get().count},R=function(e,t,n){for(var r,o,i=t.get(),a=O.toArray(e.getBody().getElementsByTagName("span")),c=0;c<a.length;c++){var u=B(a[c]);null!==u&&u.length&&(u===i.index.toString()&&(r=r||a[c].firstChild,o=a[c].firstChild),we(a[c]))}if(t.set(g(g({},i),{index:-1,count:0,text:""})),r&&o)return(t=e.dom.createRng()).setStart(r,0),t.setEnd(o,o.data.length),!1!==n&&e.selection.setRng(t),t},Ce=function(i,a){function c(e){(1<a.get().count?e.enable:e.disable)("next"),(1<a.get().count?e.enable:e.disable)("prev")}function o(e,t){t=t?e.disable:e.enable,m(["replace","replaceall","prev","next"],t)}function u(e,t){w.browser.isSafari()&&w.deviceType.isTouch()&&("find"===t||"replace"===t||"replaceall"===t)&&e.focus(t)}function l(e){R(i,a,!1),o(e,!0),c(e)}function s(e){var t,n=e.getData(),r=a.get();(n.findtext.length?(r.text===n.findtext&&r.matchCase===n.matchcase&&r.wholeWord===n.wholewords?F(i,a):((r=Oe(i,a,n.findtext,n.matchcase,n.wholewords,n.inselection))<=0&&(t=e,i.windowManager.alert("Could not find the specified string.",function(){t.focus("findtext")})),o(e,0===r)),c):l)(e)}var e=xe(),t=(i.undoManager.add(),O.trim(i.selection.getContent({format:"text"}))),n=a.get(),t={findtext:t,replacetext:"",wholewords:n.wholeWord,matchcase:n.matchCase,inselection:n.inSelection};e.set(i.windowManager.open({title:"Find and Replace",size:"normal",body:{type:"panel",items:[{type:"bar",items:[{type:"input",name:"findtext",placeholder:"Find",maximized:!0,inputMode:"search"},{type:"button",name:"prev",text:"Previous",icon:"action-prev",disabled:!0,borderless:!0},{type:"button",name:"next",text:"Next",icon:"action-next",disabled:!0,borderless:!0}]},{type:"input",name:"replacetext",placeholder:"Replace with",inputMode:"search"}]},buttons:[{type:"menu",name:"options",icon:"preferences",tooltip:"Preferences",align:"start",items:[{type:"togglemenuitem",name:"matchcase",text:"Match case"},{type:"togglemenuitem",name:"wholewords",text:"Find whole words only"},{type:"togglemenuitem",name:"inselection",text:"Find in selection"}]},{type:"custom",name:"find",text:"Find",primary:!0},{type:"custom",name:"replace",text:"Replace",disabled:!0},{type:"custom",name:"replaceall",text:"Replace all",disabled:!0}],initialData:t,onChange:function(e,t){"findtext"===t.name&&0<a.get().count&&l(e)},onAction:function(e,t){var n,r,o=e.getData();switch(t.name){case"find":s(e);break;case"replace":(M(i,a,o.replacetext)?c:l)(e);break;case"replaceall":M(i,a,o.replacetext,!0,!0),l(e);break;case"prev":I(i,a),c(e);break;case"next":F(i,a),c(e);break;case"matchcase":case"wholewords":case"inselection":n=(n=e).getData(),r=a.get(),a.set(g(g({},r),{matchCase:n.matchcase,wholeWord:n.wholewords,inSelection:n.inselection})),l(e)}u(e,t.name)},onSubmit:function(e){s(e),u(e,"find")},onClose:function(){i.focus(),R(i,a),i.undoManager.add()}},{inline:"toolbar"}))},P=function(e,t){return function(){Ce(e,t)}};D.add("searchreplace",function(e){var t,n,r,o,i,a,c=u({index:-1,count:0,text:"",matchCase:!1,wholeWord:!1,inSelection:!1});return n=c,(t=e).addCommand("SearchReplace",function(){Ce(t,n)}),o=c,(r=e).ui.registry.addMenuItem("searchreplace",{text:"Find and replace...",shortcut:"Meta+F",onAction:P(r,o),icon:"search"}),r.ui.registry.addButton("searchreplace",{tooltip:"Find and replace",onAction:P(r,o),icon:"search"}),r.shortcuts.add("Meta+F","",P(r,o)),i=e,a=c,{done:function(e){return R(i,a,e)},find:function(e,t,n,r){return Oe(i,a,e,t,n,r=void 0===r?!1:r)},next:function(){return F(i,a)},prev:function(){return I(i,a)},replace:function(e,t,n){return M(i,a,e,t,n)}}})}();