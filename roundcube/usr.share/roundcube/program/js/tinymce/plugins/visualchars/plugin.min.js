!function(){"use strict";function n(t){return function(n){return typeof n===t}}function t(n){return function(){return n}}function e(n){return n}function o(){return f}var r,i=tinymce.util.Tools.resolve("tinymce.PluginManager"),u=function(n){return t=typeof(n=n),(null===n?"null":"object"==t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t)===r;var t},c=n("boolean"),a=n("number"),s=t(!(r="string")),l=t(!0),f={fold:function(n,t){return n()},isSome:s,isNone:l,getOr:e,getOrThunk:d,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:t(null),getOrUndefined:t(void 0),or:e,orThunk:d,map:o,each:function(){},bind:o,exists:s,forall:l,filter:function(){return f},toArray:function(){return[]},toString:t("none()")};function d(n){return n()}function m(n,t){for(var e=0,o=n.length;e<o;e++)t(n[e],e)}function v(n,t){for(var e=F(n),o=0,r=e.length;o<r;o++){var i=e[o];t(n[i],i)}}function g(n){return n.dom.nodeValue}function h(n,t,e){if(n=n.dom,!(u(e)||c(e)||a(e)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",e,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(t,e+"")}function p(n,t){n.dom.removeAttribute(t)}function y(n,t){return void 0===(n=function(n,t){n=n.dom.getAttribute(t);return null===n?void 0:n}(n,t))||""===n?[]:n.split(" ")}function b(n){return void 0!==n.dom.classList}function w(n,t){var e="class";t=y(n,e).concat([t]),h(n,e,t.join(" "))}function k(n,t){var e,o;e=t,0<(o=function(n,t){for(var e=[],o=0,r=n.length;o<r;o++){var i=n[o];t(i,o)&&e.push(i)}return e}(y(t=n,n="class"),function(n){return n!==e})).length?h(t,n,o.join(" ")):p(t,n)}function A(n){0===(b(n)?n.dom.classList:y(n,"class")).length&&p(n,"class")}function D(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}}function C(n,t){var e="";return v(n,function(n,t){e+=t}),new RegExp("["+e+"]",t?"g":"")}function I(n){return'<span data-mce-bogus="1" class="mce-'+L[n]+'">'+n+"</span>"}function M(n){var t=g(n);return K(n)&&void 0!==t&&R.test(t)}function N(n,t){var e=[],n=function(n,t){for(var e=n.length,o=new Array(e),r=0;r<e;r++){var i=n[r];o[r]=t(i,r)}return o}(n.dom.childNodes,E);return m(n,function(n){e=(e=t(n)?e.concat([n]):e).concat(N(n,t))}),e}function O(n){return"span"===n.nodeName.toLowerCase()&&n.classList.contains("mce-nbsp-wrap")}function T(i,n){n=N(E(n),M),m(n,function(n){var t,e=n.dom.parentNode;if(O(e))e=E(e),t=j,b(e)?e.dom.classList.add(t):w(e,t);else{for(var o,e=i.dom.encode(g(n)).replace(U,I),r=i.dom.create("div",null,e);o=r.lastChild;)i.dom.insertAfter(o,n.dom);i.dom.remove(n.dom)}})}function S(o,n){n=o.dom.select(q,n),m(n,function(n){var t,e;O(n)?(t=E(n),e=j,b(t)?t.dom.classList.remove(e):k(t,e),A(t)):o.dom.remove(n,!0)})}var B,V,F=Object.keys,K=("undefined"==typeof window&&Function("return this;")(),B=3,function(n){return n.dom.nodeType===B}),E=D,L={" ":"nbsp","­":"shy"},R=C(L),U=C(L,!0),q=(V="",v(L,function(n){V&&(V+=","),V+="span.mce-"+n}),V),j="mce-nbsp",P=function(n){var t=n.getBody(),e=n.selection.getBookmark(),o=function(n,t){for(;n.parentNode;){if(n.parentNode===t)return n;n=n.parentNode}}(n.selection.getNode(),t);S(n,o=void 0!==o?o:t),T(n,o),n.selection.moveToBookmark(e)},x=function(n,t){o=n,e=t.get(),o.fire("VisualChars",{state:e});var e,o=n.getBody();(!0===t.get()?T:S)(n,o)},z=function(n,t){t.set(!t.get());var e=n.selection.getBookmark();x(n,t),n.selection.moveToBookmark(e)},G=function(n){return!1!==n.getParam("forced_root_block")},H=tinymce.util.Tools.resolve("tinymce.util.Delay"),_=function(e,o){return function(t){t.setActive(o.get());function n(n){return t.setActive(n.state)}return e.on("VisualChars",n),function(){return e.off("VisualChars",n)}}};i.add("visualchars",function(n){d=n.getParam("visualchars_default_state",!1),t=d;var t,e,o,r,i,u,c,a,s,l,f,d={get:function(){return t},set:function(n){t=n}};function m(){return r.execCommand("mceVisualChars")}return o=d,(e=n).addCommand("mceVisualChars",function(){z(e,o)}),i=d,(r=n).ui.registry.addToggleButton("visualchars",{tooltip:"Show invisible characters",icon:"visualchars",onAction:m,onSetup:_(r,i)}),r.ui.registry.addToggleMenuItem("visualchars",{text:"Show invisible characters",icon:"visualchars",onAction:m,onSetup:_(r,i)}),u=n,c=d,a=H.debounce(function(){P(u)},300),G(u)&&u.on("keydown",function(n){!0===c.get()&&(13===n.keyCode?P(u):a())}),u.on("remove",a.stop),l=d,(s=n).on("init",function(){x(s,l)}),f=d,{isEnabled:function(){return f.get()}}})}();